import{$t as e,At as t,Bn as n,Ct as r,Dt as i,Et as a,Ft as o,Gt as s,It as c,Jt as l,Kt as u,Lt as d,Mt as f,Nt as p,Ot as m,Pt as h,Qt as g,Rt as _,St as v,Tt as y,Wt as ee,Yt as b,Zt as x,_t as te,bt as ne,c as re,cn as S,ct as C,dt as w,ft as T,gt as ie,ht as ae,it as oe,jt as se,kn as E,kt as ce,lt as D,mt as le,ot as ue,pt as de,qt as fe,r as pe,sn as me,st as he,un as O,ut as k,vt as A,wt as j,xt as M,yn as N,yt as P,zn as F}from"./ui-CdsL-WMe.js";import"./common-B7iQJWwr.js";import{n as I,t as L}from"./index-KvlnPhMc.js";function R(e,t){for(var n=-1,r=e==null?0:e.length;++n<r&&t(e[n],n,e)!==!1;);return e}var ge=R,z=_?_.isConcatSpreadable:void 0;function _e(e){return o(e)||m(e)||!!(z&&e&&e[z])}var ve=_e;function B(e,t,n,r,i){var a=-1,o=e.length;for(n||=ve,i||=[];++a<o;){var s=e[a];t>0&&n(s)?t>1?B(s,t-1,n,r,i):P(i,s):r||(i[i.length]=s)}return i}var ye=B;function be(e){return e!=null&&e.length?ye(e,1):[]}var xe=be;function Se(e){return f(ce(e,void 0,xe),e+``)}var Ce=Se;function we(e,n){return e&&t(n,j(n),e)}var Te=we;function Ee(e,n){return e&&t(n,r(n),e)}var De=Ee;function Oe(e,n){return t(e,T(e),n)}var ke=Oe,V=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)P(t,T(e)),e=A(e);return t}:de;function Ae(e,n){return t(e,V(e),n)}var je=Ae;function Me(e){return w(e,r,V)}var H=Me,Ne=Object.prototype.hasOwnProperty;function Pe(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]==`string`&&Ne.call(e,`index`)&&(n.index=e.index,n.input=e.input),n}var Fe=Pe;function Ie(e,t){var n=t?C(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var Le=Ie,Re=/\w*$/;function ze(e){var t=new e.constructor(e.source,Re.exec(e));return t.lastIndex=e.lastIndex,t}var Be=ze,U=_?_.prototype:void 0,W=U?U.valueOf:void 0;function Ve(e){return W?Object(W.call(e)):{}}var He=Ve,Ue=`[object Boolean]`,We=`[object Date]`,Ge=`[object Map]`,Ke=`[object Number]`,qe=`[object RegExp]`,Je=`[object Set]`,Ye=`[object String]`,Xe=`[object Symbol]`,Ze=`[object ArrayBuffer]`,Qe=`[object DataView]`,$e=`[object Float32Array]`,et=`[object Float64Array]`,tt=`[object Int8Array]`,nt=`[object Int16Array]`,rt=`[object Int32Array]`,it=`[object Uint8Array]`,at=`[object Uint8ClampedArray]`,ot=`[object Uint16Array]`,st=`[object Uint32Array]`;function ct(e,t,n){var r=e.constructor;switch(t){case Ze:return C(e);case Ue:case We:return new r(+e);case Qe:return Le(e,n);case $e:case et:case tt:case nt:case rt:case it:case at:case ot:case st:return he(e,n);case Ge:return new r;case Ke:case Ye:return new r(e);case qe:return Be(e);case Je:return new r;case Xe:return He(e)}}var lt=ct,ut=`[object Map]`;function dt(e){return d(e)&&D(e)==ut}var ft=dt,G=y&&y.isMap,pt=G?a(G):ft,mt=`[object Set]`;function ht(e){return d(e)&&D(e)==mt}var gt=ht,K=y&&y.isSet,_t=K?a(K):gt,vt=1,yt=2,bt=4,q=`[object Arguments]`,xt=`[object Array]`,St=`[object Boolean]`,Ct=`[object Date]`,wt=`[object Error]`,J=`[object Function]`,Tt=`[object GeneratorFunction]`,Et=`[object Map]`,Dt=`[object Number]`,Y=`[object Object]`,Ot=`[object RegExp]`,kt=`[object Set]`,At=`[object String]`,jt=`[object Symbol]`,Mt=`[object WeakMap]`,Nt=`[object ArrayBuffer]`,Pt=`[object DataView]`,Ft=`[object Float32Array]`,It=`[object Float64Array]`,Lt=`[object Int8Array]`,Rt=`[object Int16Array]`,zt=`[object Int32Array]`,Bt=`[object Uint8Array]`,Vt=`[object Uint8ClampedArray]`,Ht=`[object Uint16Array]`,Ut=`[object Uint32Array]`,X={};X[q]=X[xt]=X[Nt]=X[Pt]=X[St]=X[Ct]=X[Ft]=X[It]=X[Lt]=X[Rt]=X[zt]=X[Et]=X[Dt]=X[Y]=X[Ot]=X[kt]=X[At]=X[jt]=X[Bt]=X[Vt]=X[Ht]=X[Ut]=!0,X[wt]=X[J]=X[Mt]=!1;function Z(e,t,n,a,s,c){var l,u=t&vt,d=t&yt,f=t&bt;if(n&&(l=s?n(e,a,s,c):n(e)),l!==void 0)return l;if(!h(e))return e;var m=o(e);if(m){if(l=Fe(e),!u)return p(e,l)}else{var g=D(e),_=g==J||g==Tt;if(i(e))return le(e,u);if(g==Y||g==q||_&&!s){if(l=d||_?{}:ue(e),!u)return d?je(e,De(l,e)):ke(e,Te(l,e))}else{if(!X[g])return s?e:{};l=lt(e,g,u)}}c||=new ae;var v=c.get(e);if(v)return v;c.set(e,l),_t(e)?e.forEach(function(r){l.add(Z(r,t,n,r,e,c))}):pt(e)&&e.forEach(function(r,i){l.set(i,Z(r,t,n,i,e,c))});var y=m?void 0:(f?d?H:k:d?r:j)(e);return ge(y||e,function(r,i){y&&(i=r,r=e[i]),se(l,i,Z(r,t,n,i,e,c))}),l}var Wt=Z;function Gt(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var Kt=Gt;function qt(e,t){return t.length<2?e:ne(e,ie(t,0,-1))}var Jt=qt;function Q(e,t){return t=v(t,e),e=Jt(e,t),e==null||delete e[M(Kt(t))]}var Yt=Q;function Xt(e){return te(e)?void 0:e}var Zt=Xt,Qt=1,$t=2,en=4,$=Ce(function(e,n){var r={};if(e==null)return r;var i=!1;n=c(n,function(t){return t=v(t,e),i||=t.length>1,t}),t(e,H(e),r),i&&(r=Wt(r,Qt|$t|en,Zt));for(var a=n.length;a--;)Yt(r,n[a]);return r}),tn={class:`log-line`},nn={class:`log-line-left`},rn={class:`timestamp`},an={class:`message`},on={key:0},sn={class:`h-full flex items-center`},cn=85,ln=L(e({__name:`LogsPageView`,setup(e){let t=I(),r=s(()=>t.getToken()),i=E([]),a=E(),o=E(null),c=s(()=>`calc(100vh - ${t.contentSafeTop+t.contentSafeBottom}px)`),d=s(()=>[...i.value].reverse()),f=null,p=1;function m(e){switch(e){case`DEBUG`:return`indigo`;case`INFO`:return`info`;case`WARN`:return`warning`;case`ERROR`:return`error`;default:return``}}return S(()=>{f=new EventSource(`/api/v1/logs?token=${r.value}`),f.onmessage=e=>{let t=JSON.parse(e.data);t.forEach(e=>{e.time=new Date(e.time).toLocaleString(),e._k=p++});let n=[...i.value,...t];if(n.length>500){let e=n.length-500;n.splice(0,e)}i.value=n}}),me(()=>{f&&f.close()}),(e,t)=>{let r=oe,i=pe,s=re;return O(),b(`div`,null,[u(`div`,{class:`log-container`,ref_key:`containerRef`,ref:o,style:F({height:c.value})},[g(i,{ref_key:`virtualListRef`,ref:a,class:`virtual-log-list`,items:d.value,"item-size":cn,"key-field":`_k`,"item-resizable":``},{default:N(({item:e})=>[u(`div`,tn,[u(`div`,nn,[g(r,{class:`level-chip`,size:`small`,type:m(e.level),label:``},{default:N(()=>[x(n(e.level),1)]),_:2},1032,[`type`]),u(`span`,rn,n(e.time),1)]),u(`span`,an,[u(`span`,null,n(e.msg),1),Object.keys($(e,[`level`,`time`,`msg`,`_k`])).length>0?(O(),b(`span`,on,n($(e,[`level`,`time`,`msg`,`_k`])),1)):l(``,!0)])])]),_:1},8,[`items`])],4),(O(),fe(ee,{to:`#header`,defer:``},[u(`div`,sn,[g(s,{class:`m-0 text-lg`},{default:N(()=>[...t[0]||=[x(`日志`,-1)]]),_:1})])]))])}}}),[[`__scopeId`,`data-v-54699dbb`]]);export{ln as default};
//# sourceMappingURL=LogsPageView-jD38-fzQ.js.map