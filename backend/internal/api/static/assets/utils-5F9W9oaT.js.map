{"version":3,"file":"utils-5F9W9oaT.js","names":[],"sources":["../../src/common/utils.ts"],"sourcesContent":["import dayjs from 'dayjs'\nimport { h } from 'vue'\nimport { NIcon, type IconProps, type MessageApi } from 'naive-ui'\n\nexport const sleep = (ms: number) => {\n  return new Promise((resolve) => setTimeout(resolve, ms))\n}\n\n// 渲染菜单图标\nexport const renderIcon = (icon: any, props?: IconProps) => {\n  return () => h(NIcon, props, { default: () => h(icon) })\n}\n\n/**\n * 显示包含换行符的错误消息\n * @param message MessageApi 实例\n * @param msg 错误消息（可能包含 \\n）\n * @param duration 显示时长（毫秒），默认 5000\n */\nexport const showErrorWithNewlines = (message: MessageApi, msg: string, duration = 5000) => {\n  // 将 \\n 分割成多行\n  const lines = msg.split('\\\\n')\n  message.error(\n    () =>\n      h(\n        'div',\n        { style: { whiteSpace: 'pre-wrap', maxWidth: '500px' } },\n        lines.map((line, index) => h('div', { key: index }, line || ' ')),\n      ),\n    { duration },\n  )\n}\n\n/**\n * 显示包含换行符的警告消息\n * @param message MessageApi 实例\n * @param msg 警告消息（可能包含 \\n）\n * @param duration 显示时长（毫秒），默认 5000\n */\nexport const showWarningWithNewlines = (message: MessageApi, msg: string, duration = 5000) => {\n  const lines = msg.split('\\\\n')\n  message.warning(\n    () =>\n      h(\n        'div',\n        { style: { whiteSpace: 'pre-wrap', maxWidth: '500px' } },\n        lines.map((line, index) => h('div', { key: index }, line || ' ')),\n      ),\n    { duration },\n  )\n}\n\n// 格式化百分比\nexport const formatPercent = (value: number): string => {\n  return `${value.toFixed(2)}%`\n}\n\n// 格式化字节数\nexport const formatBytes = (bytes: number): string => {\n  if (bytes === 0) {\n    return '0 B'\n  }\n  const k = 1024\n  const sizes = ['B', 'KB', 'MB', 'GB', 'TB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return `${(bytes / Math.pow(k, i)).toFixed(2)} ${sizes[i]}`\n}\n\n// 格式化网速（字节每秒）\nexport const formatBytesPerSecond = (bytesPerSecond: number): string => {\n  if (bytesPerSecond === 0) {\n    return '0 B/s'\n  }\n  const k = 1024\n  const sizes = ['B/s', 'KB/s', 'MB/s', 'GB/s', 'TB/s']\n  const i = Math.floor(Math.log(bytesPerSecond) / Math.log(k))\n  return `${(bytesPerSecond / Math.pow(k, i)).toFixed(2)} ${sizes[i]}`\n}\n\nexport const formatTime = (startedAt: string): string => {\n  if (!startedAt) {\n    return '-'\n  }\n  const start = dayjs(startedAt)\n  const now = dayjs()\n  const diffMs = now.diff(start)\n\n  const days = Math.floor(diffMs / (1000 * 60 * 60 * 24))\n  const hours = Math.floor((diffMs % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60))\n  const minutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60))\n\n  if (days > 0) {\n    return `${days}d ${hours}h ${minutes}m`\n  } else if (hours > 0) {\n    return `${hours}h ${minutes}m`\n  } else {\n    return `${minutes}m`\n  }\n}\n\n// 格式化数字\nexport const formatNumber = (num: number) => {\n  return num.toLocaleString()\n}\n\n// 格式化时长（秒）\nexport const formatDuration = (seconds: number) => {\n  if (seconds < 1) {\n    return seconds.toFixed(2) + '秒'\n  }\n\n  const days = Math.floor(seconds / 86400)\n  const hours = Math.floor((seconds % 86400) / 3600)\n  const minutes = Math.floor((seconds % 3600) / 60)\n  const secs = Math.floor(seconds % 60)\n\n  const parts = []\n  if (days > 0) {\n    parts.push(`${days}天`)\n  }\n  if (hours > 0) {\n    parts.push(`${hours}小时`)\n  }\n  if (minutes > 0) {\n    parts.push(`${minutes}分`)\n  }\n  if (secs > 0 || parts.length === 0) {\n    parts.push(`${secs}秒`)\n  }\n\n  return parts.join(' ')\n}\n\n// 获取CPU使用率颜色\nexport const getCpuColor = (percent: number): string => {\n  if (percent < 50) {\n    return '#52c41a'\n  } // 绿色\n  if (percent < 80) {\n    return '#faad14'\n  } // 黄色\n  return '#ff4d4f' // 红色\n}\n\n// 获取内存使用率颜色\nexport const getMemoryColor = (percent: number): string => {\n  if (percent < 60) {\n    return '#52c41a'\n  } // 绿色\n  if (percent < 85) {\n    return '#faad14'\n  } // 黄色\n  return '#ff4d4f' // 红色\n}\n\n// 检测是否为移动设备\nexport const isMobile = (): boolean => {\n  const userAgent = navigator.userAgent.toLowerCase()\n  const mobileKeywords = [\n    'android',\n    'webos',\n    'iphone',\n    'ipad',\n    'ipod',\n    'blackberry',\n    'windows phone',\n    'mobile',\n  ]\n  return mobileKeywords.some((keyword) => userAgent.includes(keyword))\n}\n\n// 检测是否为平板设备\nexport const isTablet = (): boolean => {\n  const userAgent = navigator.userAgent.toLowerCase()\n  const isIPad = userAgent.includes('ipad')\n  const isAndroidTablet = userAgent.includes('android') && !userAgent.includes('mobile')\n  const isTabletUA = userAgent.includes('tablet')\n\n  // 检测 iPad 桌面模式：\n  // 当 iPad 开启\"请求桌面网站\"时，UA 会伪装成 Mac (MacIntel)\n  // 但 iPad 有触摸支持，真正的 Mac（不带触摸屏）没有\n  const isMacWithTouch =\n    navigator.platform === 'MacIntel' &&\n    navigator.maxTouchPoints > 0 &&\n    // 确保屏幕尺寸符合平板范围\n    window.innerWidth >= 768\n\n  // 结合屏幕尺寸判断（可选）\n  const hasTabletScreen = window.innerWidth >= 768 && window.innerWidth <= 1024\n\n  return (\n    isIPad || isMacWithTouch || isAndroidTablet || isTabletUA || (hasTabletScreen && isMobile())\n  )\n}\n\n// 检测是否为手机（排除平板）\nexport const isPhone = (): boolean => {\n  return isMobile() && !isTablet()\n}\n\n// 获取设备类型\nexport const getDeviceType = (): 'desktop' | 'tablet' | 'mobile' => {\n  if (isTablet()) {\n    return 'tablet'\n  }\n  if (isPhone()) {\n    return 'mobile'\n  }\n  return 'desktop'\n}\n\n// YAML 校验结果接口\nexport interface YamlValidationResult {\n  isValid: boolean\n  errorMessage: string\n}\n\n/**\n * 校验 Docker Compose YAML 配置\n * @param yamlContent YAML 内容\n * @returns 校验结果，包含 isValid 和 errorMessage\n */\nexport const validateComposeYaml = (yamlContent: string): YamlValidationResult => {\n  try {\n    const yaml = yamlContent.trim()\n\n    // 检查是否为空\n    if (!yaml) {\n      return {\n        isValid: false,\n        errorMessage: '请输入 YAML 配置',\n      }\n    }\n\n    // 检查是否包含 services 配置\n    if (!yaml.includes('services:')) {\n      return {\n        isValid: false,\n        errorMessage: '缺少 services 配置',\n      }\n    }\n\n    // 检查缩进和基本语法\n    const lines = yaml.split('\\n')\n    for (let i = 0; i < lines.length; i++) {\n      const line = lines[i]\n      // 跳过空行和注释行\n      if (!line.trim() || line.trim().startsWith('#')) {\n        continue\n      }\n\n      // 检查引号是否闭合\n      const singleQuotes = (line.match(/'/g) || []).length\n      const doubleQuotes = (line.match(/\"/g) || []).length\n      if (singleQuotes % 2 !== 0 || doubleQuotes % 2 !== 0) {\n        return {\n          isValid: false,\n          errorMessage: `第 ${i + 1} 行：引号未闭合`,\n        }\n      }\n    }\n\n    // 校验通过\n    return {\n      isValid: true,\n      errorMessage: '',\n    }\n  } catch (error) {\n    return {\n      isValid: false,\n      errorMessage: `YAML 格式错误: ${(error as Error).message}`,\n    }\n  }\n}\n"],"mappings":"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"}