import{r as e}from"./rolldown-runtime-DGruFWvd.js";import{$ as t,$t as n,Bn as r,C as i,D as a,E as o,F as s,Gt as c,H as ee,Ht as l,Jt as u,Kt as d,Ln as f,N as p,O as m,Qt as h,R as g,Rn as _,U as v,Ut as y,W as b,Wt as x,X as S,Y as C,Yt as w,Zt as T,_n as E,at as D,c as O,cn as k,fn as A,hn as j,in as M,it as N,j as te,kn as P,l as ne,m as F,n as I,nt as re,o as L,p as ie,q as R,qt as z,tn as B,un as V,yn as H,z as U}from"./ui-CdsL-WMe.js";import{i as ae}from"./common-B7iQJWwr.js";import{n as W,t as G,v as K}from"./index-KvlnPhMc.js";import{t as oe}from"./useResponsive-C7zPy5Go.js";import{t as q}from"./AddOutline-5m_57jxw.js";import{i as se,n as ce,r as le,t as ue}from"./TextOutline-DfkX3I5u.js";import{t as J}from"./CalendarOutline-CiA9mbco.js";import{t as de}from"./CheckmarkCircleOutline-CNxktTN_.js";import{t as Y}from"./CloseCircleOutline-CD61R6IW.js";import{n as fe,t as X}from"./network-CBrFw04G.js";import{n as pe,t as me}from"./GlobeOutline-Bjt2CxbA.js";import{t as Z}from"./GitNetworkOutline-CYC_thJd.js";import{t as he}from"./InformationCircleOutline-DxVonW4c.js";import{t as ge}from"./RefreshOutline-DFsFZU2a.js";import{t as _e}from"./SearchOutline-DMbt0-Bv.js";import{t as Q}from"./TrashOutline-BLUdX-Eg.js";import{l as $}from"./utils-5F9W9oaT.js";import{t as ve}from"./network-CzXgAWPP.js";import{t as ye}from"./cpu-xpYWQlJU.js";import{t as be}from"./overflowMenuVertical-DNua2xYl.js";var xe={xmlns:`http://www.w3.org/2000/svg`,"xmlns:xlink":`http://www.w3.org/1999/xlink`,viewBox:`0 0 512 512`},Se=n({name:`GridOutline`,render:function(e,t){return V(),w(`svg`,xe,t[0]||=[d(`rect`,{x:`48`,y:`48`,width:`176`,height:`176`,rx:`20`,ry:`20`,fill:`none`,stroke:`currentColor`,"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`32`},null,-1),d(`rect`,{x:`288`,y:`48`,width:`176`,height:`176`,rx:`20`,ry:`20`,fill:`none`,stroke:`currentColor`,"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`32`},null,-1),d(`rect`,{x:`48`,y:`288`,width:`176`,height:`176`,rx:`20`,ry:`20`,fill:`none`,stroke:`currentColor`,"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`32`},null,-1),d(`rect`,{x:`288`,y:`288`,width:`176`,height:`176`,rx:`20`,ry:`20`,fill:`none`,stroke:`currentColor`,"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`32`},null,-1)])}}),Ce=e(K(),1),we=[`data-theme`],Te={key:0,class:`gradient-bar`},Ee={class:`card-content`},De={class:`network-header`},Oe={class:`network-info`},ke={class:`network-name`},Ae={class:`network-id`},je={class:`network-menu`},Me={class:`network-metadata`},Ne={class:`metadata-item`},Pe={class:`metadata-item`},Fe={key:0,class:`subnet-info`},Ie={class:`subnet-label`},Le={class:`subnet-value`},Re={class:`info-cards`},ze={class:`info-card`},Be={class:`info-label`},Ve={class:`info-value`},He={class:`info-card`},Ue={class:`info-label`},We={class:`info-value-container`},Ge={class:`info-value`},Ke={key:0,class:`usage-indicator`},qe=G(n({__name:`NetworkCard`,props:{network:{}},emits:[`delete`,`detail`],setup(e,{emit:n}){let i=W(),a=e,o=I(),s=n,p=c(()=>(a.network.containerCount||0)>0),m=c(()=>[`bridge`,`host`,`none`].includes(a.network.name)),g=c(()=>a.network.id.substring(0,12)),y=c(()=>a.network.ipam?.config&&a.network.ipam.config.length>0),x=c(()=>y.value&&a.network.ipam.config[0].subnet||`-`),S=e=>e?(0,Ce.default)(e).format(`YYYY-MM-DD HH:mm`):`-`,C=e=>({bridge:`success`,overlay:`info`,host:`warning`,macvlan:`default`,none:`default`})[e]||`default`,E=e=>({local:`本地`,swarm:`Swarm`,global:`全局`})[e]||e,D=c(()=>{let e=[{key:`detail`,label:`查看详情`,icon:()=>B(v,null,{default:()=>B(he)})}];return m.value||e.push({key:`delete`,label:`删除网络`,icon:()=>B(v,{color:o.value.errorColor},{default:()=>B(Q)})}),e}),O=e=>{switch(e){case`detail`:s(`detail`);break;case`delete`:s(`delete`);break}},k=()=>{s(`detail`)};return(n,a)=>{let o=b,s=L,c=t,A=ee,j=N;return V(),w(`div`,{class:_([`network-card`,{"card-used":p.value,"card-builtin":m.value}]),"data-theme":f(i).setting.theme,onClick:k},[p.value?(V(),w(`div`,Te)):u(``,!0),d(`div`,Ee,[d(`div`,De,[d(`div`,{class:_([`network-logo`,{"logo-used":p.value}])},[h(f(v),{size:`20`},{default:H(()=>[h(f(ve))]),_:1})],2),d(`div`,Oe,[h(o,{delay:500},{trigger:H(()=>[d(`div`,ke,r(e.network.name),1)]),default:H(()=>[d(`span`,null,r(e.network.name),1)]),_:1}),d(`div`,Ae,[h(s,{depth:`3`,class:`text-xs`},{default:H(()=>[T(`ID: `+r(g.value),1)]),_:1})])]),d(`div`,je,[h(A,{options:D.value,onSelect:O,trigger:`click`},{default:H(()=>[h(c,{quaternary:``,circle:``,onClick:a[0]||=l(()=>{},[`stop`])},{icon:H(()=>[h(f(v),null,{default:H(()=>[h(f(be))]),_:1})]),_:1})]),_:1},8,[`options`])])]),d(`div`,Me,[d(`div`,Ne,[h(f(v),{size:`14`},{default:H(()=>[h(f(ye))]),_:1}),a[1]||=d(`span`,{class:`metadata-label whitespace-nowrap`},`驱动:`,-1),h(j,{round:``,type:C(e.network.driver),size:`small`,bordered:!0},{default:H(()=>[T(r(e.network.driver),1)]),_:1},8,[`type`])]),a[3]||=d(`div`,{class:`metadata-divider`},null,-1),d(`div`,Pe,[a[2]||=d(`span`,{class:`metadata-label`},`作用域:`,-1),h(j,{round:``,type:`default`,size:`small`,bordered:!0},{default:H(()=>[T(r(E(e.network.scope)),1)]),_:1})])]),y.value?(V(),w(`div`,Fe,[d(`div`,Ie,[h(f(v),{size:`14`},{default:H(()=>[h(f(me))]),_:1}),a[4]||=d(`span`,null,`子网`,-1)]),d(`div`,Le,[h(s,{code:``,class:`text-xs`},{default:H(()=>[T(r(x.value),1)]),_:1})])])):u(``,!0),d(`div`,Re,[d(`div`,ze,[d(`div`,Be,[h(f(v),{size:`14`},{default:H(()=>[h(f(J))]),_:1}),a[5]||=d(`span`,null,`创建时间`,-1)]),d(`div`,Ve,r(S(e.network.created)),1)]),d(`div`,He,[d(`div`,Ue,[h(f(v),{size:`14`},{default:H(()=>[h(f(pe))]),_:1}),a[6]||=d(`span`,null,`连接容器`,-1)]),d(`div`,We,[d(`div`,Ge,r(e.network.containerCount||0),1),p.value?(V(),w(`div`,Ke)):u(``,!0)])])])])],10,we)}}}),[[`__scopeId`,`data-v-c89ce3f2`]]),Je={class:`network-create-modal-content`},Ye={class:`flex items-center justify-between mb-3`},Xe={class:`flex justify-end gap-2 p-[12px]`},Ze=n({__name:`NetworkCreateModal`,props:{show:{type:Boolean},showModifiers:{}},emits:M([`created`],[`update:show`]),setup(e,{emit:n}){let c=I(),ee=()=>$(Z,{color:c.value.primaryColor,size:20}),l=j(e,`show`),_=n,b=X(),x=s(),D=P(null),O=P(!1),k=P(!1),M=P({name:``,driver:`bridge`,scope:`local`,internal:!1,attachable:!1,ingress:!1,enableIPv6:!1,parentInterface:``,ipam:{driver:`default`,config:[{subnet:``,gateway:``,ipRange:``}]},options:{},labels:{}}),N=P([]),F=P([]),B=[{label:`Bridge`,value:`bridge`},{label:`Overlay`,value:`overlay`},{label:`Macvlan`,value:`macvlan`},{label:`IPvlan`,value:`ipvlan`},{label:`Host`,value:`host`},{label:`None`,value:`none`}],U=[{label:`本地 (Local)`,value:`local`},{label:`Swarm`,value:`swarm`},{label:`全局 (Global)`,value:`global`}],ae={name:[{required:!0,message:`请输入网络名称`,trigger:`blur`},{pattern:/^[a-zA-Z0-9][a-zA-Z0-9_.-]*$/,message:`网络名称只能包含字母、数字、下划线、点和连字符，且必须以字母或数字开头`,trigger:`blur`}],parentInterface:[{required:!0,trigger:`blur`,validator:(e,t)=>(M.value.driver===`macvlan`||M.value.driver===`ipvlan`)&&(!t||t.trim()===``)?Error(`${M.value.driver} 驱动必须指定父网络接口`):!0}]},W={trigger:`blur`,validator:(e,t)=>t&&!/^(\d{1,3}\.){3}\d{1,3}\/\d{1,2}$/.test(t)&&!/^([0-9a-fA-F]{0,4}:){2,7}[0-9a-fA-F]{0,4}\/\d{1,3}$/.test(t)?Error(`请输入有效的 CIDR 格式，例如 IPv4: 172.20.0.0/16 或 IPv6: fd00::/64`):!0},G=()=>{M.value.ipam.config.push({subnet:``,gateway:``,ipRange:``})},K=e=>{M.value.ipam.config.splice(e,1)},oe=e=>{let t=M.value.ipam.config[e];if(t.subnet&&!t.gateway){let e=t.subnet.match(/^(\d{1,3}\.\d{1,3}\.\d{1,3}\.)\d{1,3}\/\d{1,2}$/);if(e){t.gateway=`${e[1]}1`;return}let n=t.subnet.match(/^([0-9a-fA-F:]+)\/\d{1,3}$/);if(n){let e=n[1];e.endsWith(`::`)?t.gateway=`${e}1`:e.endsWith(`:`)?t.gateway=`${e}:1`:t.gateway=`${e}::1`}}},se=()=>{N.value.push({key:``,value:``})},ce=e=>{N.value.splice(e,1)},le=()=>{F.value.push({key:``,value:``})},ue=e=>{F.value.splice(e,1)},J=()=>{l.value=!1},de=async()=>{try{await D.value?.validate(),O.value=!0;let e={name:M.value.name,driver:M.value.driver,scope:M.value.scope,internal:M.value.internal,attachable:M.value.ingress?!1:M.value.attachable,ingress:M.value.driver===`overlay`&&M.value.scope===`global`?M.value.ingress:!1,enableIPv6:M.value.enableIPv6};if(k.value){let t=M.value.ipam.config.filter(e=>e.subnet);t.length>0&&(e.ipam={driver:M.value.ipam.driver||`default`,config:t})}let t={};(M.value.driver===`macvlan`||M.value.driver===`ipvlan`)&&M.value.parentInterface&&(t.parent=M.value.parentInterface),N.value.forEach(e=>{e.key&&e.value&&(t[e.key]=e.value)}),Object.keys(t).length>0&&(e.options=t);let n={};F.value.forEach(e=>{e.key&&e.value&&(n[e.key]=e.value)}),Object.keys(n).length>0&&(e.labels=n),await b.createNetwork(e),x.success(`网络创建成功`),l.value=!1,_(`created`),Y()}catch(e){if(e?.errors)return;x.error(`创建失败：${e.message||`未知错误`}`)}finally{O.value=!1}},Y=()=>{M.value={name:``,driver:`bridge`,scope:`local`,internal:!1,attachable:!1,ingress:!1,enableIPv6:!1,parentInterface:``,ipam:{driver:`default`,config:[{subnet:``,gateway:``,ipRange:``}]},options:{},labels:{}},k.value=!1,N.value=[],F.value=[],D.value?.restoreValidation()};return E(()=>M.value.driver,e=>{e!==`macvlan`&&e!==`ipvlan`&&(M.value.parentInterface=``)}),E(()=>[M.value.driver,M.value.scope],([e,t])=>{M.value.ingress&&(e!==`overlay`||t!==`global`)&&(M.value.ingress=!1)}),E(()=>M.value.ingress,e=>{e&&M.value.attachable&&(M.value.attachable=!1)}),E(l,e=>{e||setTimeout(()=>{Y()},300)}),(e,n)=>{let s=ne,c=re,_=a,b=R,x=L,E=p,j=ie,P=v,I=t,Y=te,X=C,pe=S,me=g;return V(),z(me,{show:l.value,"onUpdate:show":n[10]||=e=>l.value=e,icon:ee(),"display-directive":`if`,preset:`dialog`,title:`创建网络`,titleClass:`network-create-modal-title`,class:`network-create-modal`,style:{padding:`0px`,width:`90vw`,maxWidth:`900px`,height:`90vh`}},{default:H(()=>[d(`div`,Je,[h(f(m),{ref_key:`formRef`,ref:D,model:M.value,rules:ae,"label-placement":`top`,"require-mark-placement":`right-hanging`},{default:H(()=>[h(s,{prefix:`bar`,class:`mt-0`},{default:H(()=>[...n[11]||=[T(`基础配置`,-1)]]),_:1}),h(_,{label:`网络名称`,path:`name`,required:``},{default:H(()=>[h(c,{value:M.value.name,"onUpdate:value":n[0]||=e=>M.value.name=e,placeholder:`请输入网络名称`,maxlength:50,"show-count":``},null,8,[`value`])]),_:1}),h(f(i),{cols:2,"x-gap":12},{default:H(()=>[h(f(o),null,{default:H(()=>[h(_,{label:`驱动类型`,path:`driver`},{default:H(()=>[h(b,{value:M.value.driver,"onUpdate:value":n[1]||=e=>M.value.driver=e,options:B,placeholder:`选择驱动类型`},null,8,[`value`])]),_:1})]),_:1}),h(f(o),null,{default:H(()=>[h(_,{label:`作用域`,path:`scope`},{default:H(()=>[h(b,{value:M.value.scope,"onUpdate:value":n[2]||=e=>M.value.scope=e,options:U,placeholder:`选择作用域`},null,8,[`value`])]),_:1})]),_:1})]),_:1}),M.value.driver===`macvlan`||M.value.driver===`ipvlan`?(V(),z(_,{key:0,label:`父网络接口 (Parent)`,path:`parentInterface`,required:``},{feedback:H(()=>[h(x,{depth:`3`,style:{"font-size":`12px`}},{default:H(()=>[T(r(M.value.driver)+` 驱动需要指定宿主机的物理网络接口作为父接口 `,1)]),_:1})]),default:H(()=>[h(c,{value:M.value.parentInterface,"onUpdate:value":n[3]||=e=>M.value.parentInterface=e,placeholder:`例如：eth0, enp0s3`},null,8,[`value`])]),_:1})):u(``,!0),h(E),h(s,{prefix:`bar`},{default:H(()=>[...n[12]||=[T(`IPAM 配置`,-1)]]),_:1}),h(_,{label:`启用自定义 IPAM 配置`},{feedback:H(()=>[h(x,{depth:`3`,style:{"font-size":`12px`}},{default:H(()=>[...n[13]||=[T(` 可配置 IPv4 和 IPv6 子网，多个配置项可同时存在 `,-1)]]),_:1})]),default:H(()=>[h(j,{value:k.value,"onUpdate:value":n[4]||=e=>k.value=e},null,8,[`value`])]),_:1}),k.value?(V(),w(y,{key:1},[h(_,{label:`IPAM 驱动`,path:`ipam.driver`},{default:H(()=>[h(c,{value:M.value.ipam.driver,"onUpdate:value":n[5]||=e=>M.value.ipam.driver=e,placeholder:`default`},null,8,[`value`])]),_:1}),(V(!0),w(y,null,A(M.value.ipam.config,(e,t)=>(V(),w(`div`,{key:t,class:`ipam-config-item`},[d(`div`,Ye,[h(x,{strong:``},{default:H(()=>[T(`子网配置 `+r(t+1),1)]),_:2},1024),M.value.ipam.config.length>1?(V(),z(I,{key:0,size:`small`,tertiary:``,type:`error`,onClick:e=>K(t)},{icon:H(()=>[h(P,null,{default:H(()=>[h(f(Q))]),_:1})]),default:H(()=>[n[14]||=T(` 删除 `,-1)]),_:1},8,[`onClick`])):u(``,!0)]),h(_,{label:`子网 ${t+1}`,path:`ipam.config[${t}].subnet`,rule:W},{default:H(()=>[h(c,{value:e.subnet,"onUpdate:value":t=>e.subnet=t,placeholder:`IPv4: 172.20.0.0/16 或 IPv6: fd00::/64`,onBlur:e=>oe(t)},null,8,[`value`,`onUpdate:value`,`onBlur`])]),_:2},1032,[`label`,`path`]),h(f(i),{cols:2,"x-gap":12},{default:H(()=>[h(f(o),null,{default:H(()=>[h(_,{label:`网关 ${t+1}`,path:`ipam.config[${t}].gateway`},{default:H(()=>[h(c,{value:e.gateway,"onUpdate:value":t=>e.gateway=t,placeholder:`IPv4: 172.20.0.1 或 IPv6: fd00::1`},null,8,[`value`,`onUpdate:value`])]),_:2},1032,[`label`,`path`])]),_:2},1024),h(f(o),null,{default:H(()=>[h(_,{label:`IP 范围 ${t+1}`,path:`ipam.config[${t}].ipRange`},{default:H(()=>[h(c,{value:e.ipRange,"onUpdate:value":t=>e.ipRange=t,placeholder:`IPv4: 172.20.10.0/24 或 IPv6: fd00:1::/80`},null,8,[`value`,`onUpdate:value`])]),_:2},1032,[`label`,`path`])]),_:2},1024)]),_:2},1024),t<M.value.ipam.config.length-1?(V(),z(E,{key:0})):u(``,!0)]))),128)),h(I,{dashed:``,block:``,onClick:G,class:`mb-4`},{icon:H(()=>[h(P,null,{default:H(()=>[h(f(q))]),_:1})]),default:H(()=>[n[15]||=T(` 添加子网配置 `,-1)]),_:1})],64)):u(``,!0),h(E),h(pe,null,{default:H(()=>[h(X,{title:`高级选项`,name:`advanced`},{default:H(()=>[h(f(i),{cols:`2 s:1`,"x-gap":12,"y-gap":12},{default:H(()=>[h(f(o),null,{default:H(()=>[h(_,{label:`启用 IPv6`},{feedback:H(()=>[h(x,{depth:`3`,style:{"font-size":`12px`}},{default:H(()=>[...n[16]||=[T(` 启用后可在 IPAM 配置中添加 IPv6 子网 `,-1)]]),_:1})]),default:H(()=>[h(j,{value:M.value.enableIPv6,"onUpdate:value":n[6]||=e=>M.value.enableIPv6=e},null,8,[`value`])]),_:1})]),_:1}),h(f(o),null,{default:H(()=>[h(_,{label:`内部网络 (Isolate)`},{feedback:H(()=>[h(x,{depth:`3`,style:{"font-size":`12px`}},{default:H(()=>[...n[17]||=[T(` 内部网络无法访问外部网络 `,-1)]]),_:1})]),default:H(()=>[h(j,{value:M.value.internal,"onUpdate:value":n[7]||=e=>M.value.internal=e},null,8,[`value`])]),_:1})]),_:1}),h(f(o),null,{default:H(()=>[h(_,{label:`可连接 (Attachable)`},{feedback:H(()=>[h(x,{depth:`3`,style:{"font-size":`12px`}},{default:H(()=>[T(r(M.value.ingress?`Ingress 网络不支持 Attachable 选项`:`允许容器动态连接到此网络`),1)]),_:1})]),default:H(()=>[h(j,{value:M.value.attachable,"onUpdate:value":n[8]||=e=>M.value.attachable=e,disabled:M.value.ingress},null,8,[`value`,`disabled`])]),_:1})]),_:1}),h(f(o),null,{default:H(()=>[h(_,{label:`Ingress 网络`},{feedback:H(()=>[h(x,{depth:`3`},{default:H(()=>[T(r(M.value.driver===`overlay`?M.value.scope===`global`?`Swarm 模式下的 Ingress 网络`:`Ingress 网络仅在 Global 作用域下可用`:`Ingress 网络仅支持 Overlay 驱动`),1)]),_:1})]),default:H(()=>[h(j,{value:M.value.ingress,"onUpdate:value":n[9]||=e=>M.value.ingress=e,disabled:M.value.scope!==`global`||M.value.driver!==`overlay`},null,8,[`value`,`disabled`])]),_:1})]),_:1}),h(f(o),{span:2},{default:H(()=>[h(E,{style:{margin:`8px 0`}}),h(x,{strong:``},{default:H(()=>[...n[18]||=[T(`驱动选项`,-1)]]),_:1})]),_:1}),h(f(o),{span:2},{default:H(()=>[h(Y,{vertical:``,size:`small`},{default:H(()=>[(V(!0),w(y,null,A(N.value,(e,t)=>(V(),w(`div`,{key:t,class:`option-item`},[h(f(i),{cols:`3`,"x-gap":8},{default:H(()=>[h(f(o),null,{default:H(()=>[h(c,{value:e.key,"onUpdate:value":t=>e.key=t,placeholder:`键`,size:`small`},null,8,[`value`,`onUpdate:value`])]),_:2},1024),h(f(o),null,{default:H(()=>[h(c,{value:e.value,"onUpdate:value":t=>e.value=t,placeholder:`值`,size:`small`},null,8,[`value`,`onUpdate:value`])]),_:2},1024),h(f(o),null,{default:H(()=>[h(I,{size:`small`,tertiary:``,type:`error`,onClick:e=>ce(t),block:``},{icon:H(()=>[h(P,null,{default:H(()=>[h(f(fe))]),_:1})]),default:H(()=>[n[19]||=T(` 删除 `,-1)]),_:1},8,[`onClick`])]),_:2},1024)]),_:2},1024)]))),128)),h(I,{dashed:``,block:``,onClick:se,size:`small`},{icon:H(()=>[h(P,null,{default:H(()=>[h(f(q))]),_:1})]),default:H(()=>[n[20]||=T(` 添加驱动选项 `,-1)]),_:1})]),_:1})]),_:1}),h(f(o),{span:2},{default:H(()=>[h(E,{style:{margin:`8px 0`}}),h(x,{strong:``},{default:H(()=>[...n[21]||=[T(`标签`,-1)]]),_:1})]),_:1}),h(f(o),{span:2},{default:H(()=>[h(Y,{vertical:``,size:`small`},{default:H(()=>[(V(!0),w(y,null,A(F.value,(e,t)=>(V(),w(`div`,{key:t,class:`option-item`},[h(f(i),{cols:`3`,"x-gap":8},{default:H(()=>[h(f(o),null,{default:H(()=>[h(c,{value:e.key,"onUpdate:value":t=>e.key=t,placeholder:`键`,size:`small`},null,8,[`value`,`onUpdate:value`])]),_:2},1024),h(f(o),null,{default:H(()=>[h(c,{value:e.value,"onUpdate:value":t=>e.value=t,placeholder:`值`,size:`small`},null,8,[`value`,`onUpdate:value`])]),_:2},1024),h(f(o),null,{default:H(()=>[h(I,{size:`small`,tertiary:``,type:`error`,onClick:e=>ue(t),block:``},{icon:H(()=>[h(P,null,{default:H(()=>[h(f(fe))]),_:1})]),default:H(()=>[n[22]||=T(` 删除 `,-1)]),_:1},8,[`onClick`])]),_:2},1024)]),_:2},1024)]))),128)),h(I,{dashed:``,block:``,onClick:le,size:`small`},{icon:H(()=>[h(P,null,{default:H(()=>[h(f(q))]),_:1})]),default:H(()=>[n[23]||=T(` 添加标签 `,-1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,[`model`])]),d(`div`,Xe,[h(I,{onClick:J},{default:H(()=>[...n[24]||=[T(`取消`,-1)]]),_:1}),h(I,{type:`primary`,onClick:de,loading:O.value},{default:H(()=>[...n[25]||=[T(`创建`,-1)]]),_:1},8,[`loading`])])]),_:1},8,[`show`,`icon`])}}}),Qe={class:`networks-page`},$e={class:`networks-content`},et={key:0,class:`empty-state`},tt={class:`welcome-card`},nt={class:`flex gap-2`},rt=G(n({__name:`NetworksView`,setup(e){let n=X(),{isMobile:i,isTablet:a,isLaptop:o,isDesktop:l,isDesktopLarge:u}=oe(),p=ae(),m=U(),g=s(),b=P(``),S=P(null),C=P(`name`),E=P(`asc`),j=P(!1),M=c(()=>[{label:`全部`,key:null,icon:$(se)},{label:`使用中`,key:`used`,icon:$(de)},{label:`未使用`,key:`unused`,icon:$(Y)},{label:`内置网络`,key:`builtin`,icon:$(Z)},{label:`自定义网络`,key:`custom`,icon:$(Se)},{type:`divider`,key:`d1`},{label:`Bridge 驱动`,key:`driver-bridge`,icon:$(Z)},{label:`Overlay 驱动`,key:`driver-overlay`,icon:$(Z)},{label:`Host 驱动`,key:`driver-host`,icon:$(Z)},{label:`Macvlan 驱动`,key:`driver-macvlan`,icon:$(Z)}]),N=c(()=>[{label:`名称 ${C.value===`name`?E.value===`asc`?`↑`:`↓`:``}`,key:`name`,icon:$(ue)},{label:`创建时间 ${C.value===`created`?E.value===`asc`?`↑`:`↓`:``}`,key:`created`,icon:$(J)}]),ne=e=>{S.value=e},I=c(()=>C.value!==`name`||E.value!==`asc`),ie=e=>{C.value===e?E.value=E.value===`asc`?`desc`:`asc`:(C.value=e,E.value=`asc`)},R=c(()=>{let e=n.networks,t=[`bridge`,`host`,`none`];if(b.value){let t=b.value.toLowerCase();e=e.filter(e=>{let n=e.name.toLowerCase().includes(t),r=e.driver.toLowerCase().includes(t),i=e.ipam?.config?.some(e=>e.subnet?.toLowerCase().includes(t))||!1;return n||r||i})}return S.value&&(e=e.filter(e=>{switch(S.value){case`used`:return e.containerCount>0;case`unused`:return e.containerCount===0;case`builtin`:return t.includes(e.name);case`custom`:return!t.includes(e.name);case`driver-bridge`:return e.driver===`bridge`;case`driver-overlay`:return e.driver===`overlay`;case`driver-host`:return e.driver===`host`;case`driver-macvlan`:return e.driver===`macvlan`;default:return!0}})),e.sort((e,t)=>{let n=0;switch(C.value){case`name`:n=e.name.localeCompare(t.name);break;case`created`:n=new Date(e.created).getTime()-new Date(t.created).getTime();break;default:n=0}return E.value===`asc`?n:-n})}),B=async e=>{if([`bridge`,`host`,`none`].includes(e.name)){g.warning(`内置网络不能删除`);return}if(e.containerCount>0){m.warning({title:`无法删除`,content:`此网络正在被 ${e.containerCount} 个容器使用，无法删除。请先断开所有容器的连接。`,positiveText:`知道了`});return}let t=m.warning({title:`确认删除`,content:`确定要删除网络 "${e.name}" 吗？此操作不可恢复。`,positiveText:`删除`,negativeText:`取消`,onPositiveClick:async()=>{try{t.loading=!0,await n.deleteNetwork(e.id),g.success(`网络删除成功`)}catch(e){g.error(`删除失败：${e.message||`未知错误`}`)}finally{t.loading=!1}}})},W=e=>{p.push(`/networks/${e.id}`)},G=async()=>{try{await n.fetchNetworks()}catch(e){g.error(`刷新失败：${e.message||`未知错误`}`)}},K=()=>{if(n.unusedNetworks.length===0){g.info(`没有未使用的网络需要清理`);return}let e=[`bridge`,`host`,`none`],t=n.networks.filter(t=>t.containerCount===0&&!e.includes(t.name)).length;if(t===0){g.info(`没有可清理的网络（内置网络不会被清理）`);return}let r=m.warning({title:`确认清理`,content:`确定要清理 ${t} 个未使用的网络吗？此操作不可恢复。（内置网络不会被清理）`,positiveText:`清理`,negativeText:`取消`,onPositiveClick:async()=>{try{r.loading=!0;let e=(await n.pruneNetworks()).networksDeleted?.length||0;g.success(`清理成功，删除了 ${e} 个网络`)}catch(e){g.error(`清理失败：${e.message||`未知错误`}`)}finally{r.loading=!1}}})};return k(async()=>{await n.fetchNetworks()}),(e,s)=>{let c=v,p=t,m=ee,g=re,C=te,E=D,k=F,P=O,U=L;return V(),w(`div`,Qe,[h(C,null,{default:H(()=>[h(m,{options:M.value,onSelect:ne},{default:H(()=>[h(p,{circle:``,size:`small`,type:S.value?`primary`:`default`},{icon:H(()=>[h(c,null,{default:H(()=>[h(f(le))]),_:1})]),_:1},8,[`type`])]),_:1},8,[`options`]),h(m,{options:N.value,onSelect:ie},{default:H(()=>[h(p,{circle:``,size:`small`,type:I.value?`primary`:`default`},{icon:H(()=>[h(c,null,{default:H(()=>[h(f(ce))]),_:1})]),_:1},8,[`type`])]),_:1},8,[`options`]),h(g,{value:b.value,"onUpdate:value":s[0]||=e=>b.value=e,placeholder:`名称、驱动或子网`,clearable:``,class:`lg:w-[400px]!`},{prefix:H(()=>[h(c,null,{default:H(()=>[h(f(_e))]),_:1})]),_:1},8,[`value`])]),_:1}),d(`div`,$e,[h(k,{show:f(n).loading&&R.value.length===0},{default:H(()=>[R.value.length===0&&!f(n).loading?(V(),w(`div`,et,[h(E,{description:`没有找到网络`},{extra:H(()=>[h(p,{onClick:G},{default:H(()=>[...s[3]||=[T(`刷新数据`,-1)]]),_:1})]),_:1})])):(V(),w(`div`,{key:1,class:_([`networks-grid`,{"grid-cols-1":f(i),"grid-cols-2":f(a),"grid-cols-3":f(o)||f(l),"grid-cols-4":f(u)}])},[(V(!0),w(y,null,A(R.value,e=>(V(),z(qe,{key:e.id,network:e,onDelete:()=>B(e),onDetail:()=>W(e)},null,8,[`network`,`onDelete`,`onDetail`]))),128))],2))]),_:1},8,[`show`])]),(V(),z(x,{to:`#header`,defer:``},[d(`div`,tt,[d(`div`,null,[h(P,{class:`m-0 text-lg`},{default:H(()=>[...s[4]||=[T(`网络管理`,-1)]]),_:1}),h(U,{depth:`3`,class:`text-xs max-md:hidden`},{default:H(()=>[T(` 共 `+r(f(n).stats.total)+` 个网络， 使用中 `+r(f(n).stats.used)+` 个， 自定义 `+r(f(n).stats.custom)+` 个 `,1)]),_:1})]),d(`div`,nt,[h(p,{onClick:G,loading:f(n).loading,circle:``,size:`tiny`},{icon:H(()=>[h(c,null,{default:H(()=>[h(f(ge))]),_:1})]),_:1},8,[`loading`]),h(p,{circle:``,size:`tiny`,onClick:s[1]||=e=>j.value=!0},{icon:H(()=>[h(c,null,{default:H(()=>[h(f(q))]),_:1})]),_:1}),h(p,{onClick:K,circle:``,tertiary:``,size:`tiny`},{icon:H(()=>[h(c,null,{default:H(()=>[h(f(Q))]),_:1})]),_:1})])])])),h(Ze,{show:j.value,"onUpdate:show":s[2]||=e=>j.value=e},null,8,[`show`])])}}}),[[`__scopeId`,`data-v-054cf672`]]);export{rt as default};
//# sourceMappingURL=NetworksView-Be65TIvY.js.map