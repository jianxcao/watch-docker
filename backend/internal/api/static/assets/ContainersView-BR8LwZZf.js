import{$ as e,$t as t,Bn as n,C as r,F as i,Gt as a,H as o,Jt as s,Kt as c,Ln as l,O as u,Q as d,Qt as f,R as ee,Rn as p,T as m,U as te,Ut as ne,Wt as h,Yt as g,Zt as _,_n as v,a as re,at as y,c as b,cn as x,et as S,fn as C,g as w,hn as T,i as E,in as D,j as O,kn as k,m as A,n as j,nt as ie,o as ae,qt as M,rt as N,s as P,un as F,yn as I}from"./ui-CdsL-WMe.js";import{i as L}from"./common-B7iQJWwr.js";import{n as R,t as z}from"./index-KvlnPhMc.js";import{t as B}from"./useResponsive-C7zPy5Go.js";import{t as V}from"./app-CSclzxOM.js";import{t as oe}from"./AddOutline-5m_57jxw.js";import{i as H,n as U,r as W,t as G}from"./TextOutline-DfkX3I5u.js";import{t as K}from"./CalendarOutline-CiA9mbco.js";import{t as q}from"./CheckmarkCircleOutline-CNxktTN_.js";import{t as J}from"./CloseCircleOutline-CD61R6IW.js";import{t as se}from"./CloudDownloadOutline-CsoTk8An.js";import{t as Y}from"./CloudUploadOutline-BHaW-Y08.js";import{n as ce,r as le,t as X}from"./ContainerLogsModal-CQm0hYa9.js";import"./DownloadOutline-C4KnaRUa.js";import"./InformationCircleOutline-DxVonW4c.js";import{n as ue,r as de}from"./LogsStreamView-DMg69Ziz.js";import{t as Z}from"./RadioButtonOnOutline-B_Feh0aZ.js";import{t as fe}from"./RefreshOutline-DFsFZU2a.js";import{t as pe}from"./SearchOutline-DMbt0-Bv.js";import"./SyncOutline-DdAvW8IC.js";import"./TrashOutline-BLUdX-Eg.js";import{t as me}from"./container-BbVEwPu1.js";import{l as Q,t as he}from"./utils-5F9W9oaT.js";import"./compose-BeaxuMAs.js";import"./log-BiY5VKye.js";import"./TermView-Dz1I8qWk.js";import{n as ge}from"./hartLine-ca9X-LCq.js";import"./cpu-xpYWQlJU.js";import"./overflowMenuVertical-DNua2xYl.js";import{t as _e}from"./useXhrUpload-DwU_B2wy.js";var ve={xmlns:`http://www.w3.org/2000/svg`,"xmlns:xlink":`http://www.w3.org/1999/xlink`,viewBox:`0 0 512 512`},ye=t({name:`RemoveCircleOutline`,render:function(e,t){return F(),g(`svg`,ve,t[0]||=[c(`path`,{d:`M448 256c0-106-86-192-192-192S64 150 64 256s86 192 192 192s192-86 192-192z`,fill:`none`,stroke:`currentColor`,"stroke-miterlimit":`10`,"stroke-width":`32`},null,-1),c(`path`,{fill:`none`,stroke:`currentColor`,"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`32`,d:`M336 256H176`},null,-1)])}}),be={class:`import-content`},xe={class:`upload-area`},$={key:0,class:`upload-progress`},Se={class:`progress-info`},Ce={class:`progress-details`},we={key:1,class:`file-info`},Te={class:`file-detail`},Ee={class:`file-meta`},De={class:`modal-actions`},Oe=z(t({__name:`ContainerImportModal`,props:{show:{type:Boolean},showModifiers:{}},emits:D([`success`],[`update:show`]),setup(t,{emit:a}){let o=j(),p=R(),ne=()=>Q(Y,{color:o.value.primaryColor,size:20}),h=T(t,`show`),y=a,b=i(),x=k(),S=k(),C=k([]),D=k(null),{uploading:A,uploadProgress:L,uploadedSize:z,totalSize:B,currentFileName:V,uploadSpeed:oe,resetState:H,upload:U,formatFileSize:W}=_e(),G=k({repository:``,tag:`latest`}),K={repository:{required:!0,message:`è¯·è¾“å…¥é•œåƒåç§°`,trigger:[`input`,`blur`]}};v(h,e=>{e&&H()});let q=e=>{let t=e.file.file;return t?t.name.endsWith(`.tar`)?t.size>5*1024*1024*1024?(b.error(`æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡ 5GB`),!1):(D.value=t,!1):(b.error(`ä»…æ”¯æŒ .tar æ ¼å¼çš„æ–‡ä»¶`),!1):!1},J=e=>{C.value=e,e.length===0&&(D.value=null)},se=()=>{},ce=async()=>{if(!D.value||!G.value.repository){b.error(`è¯·é€‰æ‹©æ–‡ä»¶å¹¶å¡«å†™é•œåƒåç§°`);return}try{await x.value?.validate()}catch{return}try{let e=new FormData;e.append(`file`,D.value),e.append(`repository`,G.value.repository),e.append(`tag`,G.value.tag),await U({url:`/api/v1/containers/import`,file:D.value,formData:e,getToken:()=>p.getToken(),onSuccess:()=>{b.success(`å®¹å™¨å¯¼å…¥æˆåŠŸ`),y(`success`),X()}})}catch(e){console.error(`å¯¼å…¥å¤±è´¥:`,e)}},X=()=>{A.value||(h.value=!1,H(),D.value=null,C.value=[],G.value={repository:``,tag:`latest`},S.value?.clear())};return(t,i)=>{let a=ie,p=m,v=r,y=u,b=te,T=ae,k=P,j=re,R=E,H=w,U=O,ue=d,de=N,Z=e,fe=ee;return F(),M(fe,{show:h.value,"onUpdate:show":i[2]||=e=>h.value=e,icon:ne(),preset:`dialog`,style:{padding:`12px`,width:`90vw`,"max-width":`600px`}},{header:I(()=>[...i[3]||=[c(`span`,null,`å¯¼å…¥å®¹å™¨`,-1)]]),action:I(()=>[c(`div`,De,[f(Z,{onClick:X,disabled:l(A)},{default:I(()=>[_(n(l(A)?`ä¸Šä¼ ä¸­...`:`å–æ¶ˆ`),1)]),_:1},8,[`disabled`]),f(Z,{type:`primary`,loading:l(A),disabled:!D.value||!G.value.repository||l(A),onClick:ce},{default:I(()=>[_(n(l(A)?`å¯¼å…¥ä¸­...`:`å¼€å§‹å¯¼å…¥`),1)]),_:1},8,[`loading`,`disabled`])])]),default:I(()=>[c(`div`,be,[f(y,{ref_key:`formRef`,ref:x,model:G.value,rules:K,"label-placement":`top`},{default:I(()=>[f(v,{cols:24,"x-gap":12},{default:I(()=>[f(p,{span:12,label:`é•œåƒåç§°`,path:`repository`},{default:I(()=>[f(a,{value:G.value.repository,"onUpdate:value":i[0]||=e=>G.value.repository=e,placeholder:`ä¾‹å¦‚: myapp`},null,8,[`value`])]),_:1}),f(p,{span:12,label:`æ ‡ç­¾`,path:`tag`},{default:I(()=>[f(a,{value:G.value.tag,"onUpdate:value":i[1]||=e=>G.value.tag=e,placeholder:`ä¾‹å¦‚: latest`},null,8,[`value`])]),_:1})]),_:1})]),_:1},8,[`model`]),f(R,{ref_key:`uploadRef`,ref:S,max:1,"file-list":C.value,"custom-request":se,accept:`.tar`,"show-file-list":!1,"directory-dnd":``,"onUpdate:fileList":J,onBeforeUpload:q},{default:I(()=>[f(j,null,{default:I(()=>[c(`div`,xe,[f(b,{size:`48`,depth:3},{default:I(()=>[f(l(Y))]),_:1}),f(T,{class:`upload-title`},{default:I(()=>[...i[4]||=[_(` ç‚¹å‡»æˆ–è€…æ‹–åŠ¨æ–‡ä»¶åˆ°è¯¥åŒºåŸŸæ¥ä¸Šä¼  `,-1)]]),_:1}),f(k,{depth:`3`,class:`upload-hint`},{default:I(()=>[...i[5]||=[_(` ä»…æ”¯æŒ .tar æ ¼å¼çš„ Docker å®¹å™¨æ–‡ä»¶ `,-1)]]),_:1})])]),_:1})]),_:1},8,[`file-list`]),l(A)?(F(),g(`div`,$,[f(U,{vertical:``},{default:I(()=>[c(`div`,Se,[f(T,null,{default:I(()=>[_(n(l(V)),1)]),_:1}),f(T,{depth:`3`},{default:I(()=>[_(n(l(W)(l(z)))+` / `+n(l(W)(l(B))),1)]),_:1})]),f(H,{type:`line`,percentage:l(L),"show-indicator":!1,height:8},null,8,[`percentage`]),c(`div`,Ce,[f(T,{depth:`3`},{default:I(()=>[_(n(l(L).toFixed(1))+`% - `+n(l(oe)),1)]),_:1})])]),_:1})])):s(``,!0),D.value?(F(),g(`div`,we,[f(ue,{size:`small`},{default:I(()=>[c(`div`,Te,[f(b,{size:`20`,color:l(o).primaryColor},{default:I(()=>[f(l(le))]),_:1},8,[`color`]),c(`div`,Ee,[f(T,{class:`file-name`},{default:I(()=>[_(n(D.value.name),1)]),_:1}),f(T,{depth:`3`,class:`file-size`},{default:I(()=>[_(n(l(he)(D.value.size)),1)]),_:1})])])]),_:1})])):s(``,!0)]),f(de,{type:`info`,class:`mt-2`},{default:I(()=>[...i[6]||=[_(` æ³¨æ„ï¼šå®¹å™¨ä¸Šä¼ åŽä¼šç”Ÿæˆå¯¹åº”çš„é•œåƒï¼Œè¯·ç”¨é•œåƒåœ¨ç»§ç»­å®¹å™¨çš„åˆ›å»º `,-1)]]),_:1})]),_:1},8,[`show`,`icon`])}}}),[[`__scopeId`,`data-v-0155ec28`]]),ke={class:`containers-page`},Ae={class:`containers-content`},je={key:0,class:`empty-state`},Me={class:`floating-actions`},Ne={class:`welcome-card`},Pe={class:`text-xs pl-1`},Fe={class:`flex gap-2`},Ie=z(t({__name:`ContainersView`,setup(t){let r=L(),i=me(),u=ge(),{isMobile:d,isTablet:ee,isLaptop:m,isDesktop:v,isDesktopLarge:re}=B(),w=V(),T=k(``),E=k(null),D=k(`name`),j=k(`asc`),N=k(!1),P=k(!1),R=k(!1),z=k(null),le=a(()=>i.wsConnectionState),he=a(()=>[{label:`å…¨éƒ¨`,key:null,icon:Q(H)},{label:`è¿è¡Œä¸­`,key:`running`,icon:Q(de)},{label:`å·²åœæ­¢`,key:`stopped`,icon:Q(ue)},{label:`å¯æ›´æ–°`,key:`updateable`,icon:Q(Y)},{label:`æœ€æ–°`,key:`uptodate`,icon:Q(q)},{label:`é”™è¯¯`,key:`error`,icon:Q(J)},{label:`è·³è¿‡æ›´æ–°`,key:`skipped`,icon:Q(ye)}]),_e=a(()=>[{label:`åç§° ${D.value===`name`?j.value===`asc`?`â†‘`:`â†“`:``}`,key:`name`,icon:Q(G)},{label:`å¯åŠ¨æ—¶é—´ ${D.value===`created`?j.value===`asc`?`â†‘`:`â†“`:``}`,key:`created`,icon:Q(K)},{label:`çŠ¶æ€ ${D.value===`status`?j.value===`asc`?`â†‘`:`â†“`:``}`,key:`status`,icon:Q(Z)}]),ve=e=>{E.value=e},be=a(()=>D.value!==`name`||j.value!==`asc`),xe=e=>{D.value===e?j.value=j.value===`asc`?`desc`:`asc`:(D.value=e,j.value=`asc`)},$=a(()=>{let e=i.containers;if(T.value){let t=T.value.toLowerCase();e=e.filter(e=>{let n=e.name.toLowerCase().includes(t)||e.image.toLowerCase().includes(t),r=e.ports?.some(e=>e.publicPort?.toString().includes(t)||e.privatePort?.toString().includes(t));return n||r})}return E.value&&(e=e.filter(e=>{switch(E.value){case`running`:return e.running;case`stopped`:return!e.running;case`updateable`:return e.status===`UpdateAvailable`&&!e.skipped;case`uptodate`:return e.status===`UpToDate`;case`error`:return e.status===`Error`;case`skipped`:return e.skipped;default:return!0}})),e.sort((e,t)=>{let n=0;switch(D.value){case`name`:n=e.name.localeCompare(t.name);break;case`created`:n=new Date(e.startedAt).getTime()-new Date(t.startedAt).getTime();break;case`status`:let r=e=>e.running?0:e.running?2:1;n=r(e)-r(t);break;default:return 0}return j.value===`asc`?n:-n})}),Se=async e=>{N.value=!0;try{await u.handleStart(e)}finally{N.value=!1}},Ce=async e=>{N.value=!0;try{await u.handleStop(e)}finally{N.value=!1}},we=async e=>{N.value=!0;try{await u.handleRestart(e)}finally{N.value=!1}},Te=async e=>{await u.handleUpdate(e)},Ee=async e=>{N.value=!0;try{await u.handleDelete(e)}finally{N.value=!1}},De=async e=>{await u.handleExport(e)},Ie=async e=>{z.value=e,R.value=!0},Le=e=>{r.push({name:`container-detail`,params:{id:e.id}})},Re=()=>{r.push({name:`container-create`})},ze=async()=>{await u.handleBatchUpdate()},Be=async()=>{w.systemHealth===`unhealthy`&&await w.checkHealth(),i.statsWebSocket.isConnected||i.statsWebSocket.connect(),await i.fetchContainers(!0,!0)},Ve=async()=>{P.value=!1,await i.fetchContainers(!0,!1)},He=a(()=>{switch(le.value){case`connected`:return`ðŸŸ¢`;case`connecting`:return`ðŸŸ¡`;case`disconnected`:return`ðŸ”´`;default:return`ðŸŸ¡`}});return x(async()=>{i.fetchContainers(!0,!0),i.statsWebSocket.connect()}),(t,r)=>{let a=te,u=e,x=o,w=ie,D=O,k=y,j=A,L=S,B=b,V=ae;return F(),g(`div`,ke,[f(D,null,{default:I(()=>[f(x,{options:he.value,onSelect:ve},{default:I(()=>[f(u,{circle:``,size:`small`,type:E.value?`primary`:`default`},{icon:I(()=>[f(a,null,{default:I(()=>[f(l(W))]),_:1})]),_:1},8,[`type`])]),_:1},8,[`options`]),f(x,{options:_e.value,onSelect:xe},{default:I(()=>[f(u,{circle:``,size:`small`,type:be.value?`primary`:`default`},{icon:I(()=>[f(a,null,{default:I(()=>[f(l(U))]),_:1})]),_:1},8,[`type`])]),_:1},8,[`options`]),f(w,{value:T.value,"onUpdate:value":r[0]||=e=>T.value=e,placeholder:`åç§°ã€é•œåƒæˆ–ç«¯å£`,clearable:``,class:`lg:w-[400px]!`},{prefix:I(()=>[f(a,null,{default:I(()=>[f(l(pe))]),_:1})]),_:1},8,[`value`])]),_:1}),c(`div`,Ae,[f(j,{show:l(i).loading&&$.value.length===0},{default:I(()=>[$.value.length===0&&!l(i).loading?(F(),g(`div`,je,[f(k,{description:`æ²¡æœ‰æ‰¾åˆ°å®¹å™¨`},{extra:I(()=>[f(u,{onClick:Be},{default:I(()=>[...r[4]||=[_(`åˆ·æ–°æ•°æ®`,-1)]]),_:1})]),_:1})])):(F(),g(`div`,{key:1,class:p([`containers-grid`,{"grid-cols-1":l(d),"grid-cols-2":l(ee)||l(m),"grid-cols-3":l(v),"grid-cols-4":l(re)}])},[(F(!0),g(ne,null,C($.value,e=>(F(),M(ce,{key:e.id,container:e,loading:N.value,onStart:()=>Se(e),onStop:()=>Ce(e),onRestart:()=>we(e),onUpdate:()=>Te(e),onDelete:()=>Ee(e),onExport:()=>De(e),onLogs:()=>Ie(e),onDetail:()=>Le(e)},null,8,[`container`,`loading`,`onStart`,`onStop`,`onRestart`,`onUpdate`,`onDelete`,`onExport`,`onLogs`,`onDetail`]))),128))],2))]),_:1},8,[`show`])]),(F(),M(h,{to:`body`},[c(`div`,Me,[l(i).updateableContainers.length>0?(F(),M(L,{key:0,value:l(i).updateableContainers.length,class:`update-badge`,type:`info`},{default:I(()=>[...r[5]||=[c(`span`,null,null,-1)]]),_:1},8,[`value`])):s(``,!0),f(D,{vertical:``,class:`relative`},{default:I(()=>[l(i).updateableContainers.length>0?(F(),M(u,{key:0,type:`primary`,size:`large`,circle:``,onClick:ze,loading:l(i).batchUpdating,class:`fab-button`},{icon:I(()=>[f(a,{size:`20`},{default:I(()=>[f(l(se))]),_:1})]),_:1},8,[`loading`])):s(``,!0)]),_:1})])])),(F(),M(h,{to:`#header`,defer:``},[c(`div`,Ne,[c(`div`,null,[f(B,{class:`m-0 text-lg`},{default:I(()=>[r[6]||=_(`å®¹å™¨ç®¡ç†`,-1),c(`span`,Pe,n(He.value),1)]),_:1}),f(V,{depth:`3`,class:`text-xs max-md:hidden`},{default:I(()=>[_(` å…± `+n(l(i).stats.total)+` ä¸ªå®¹å™¨ï¼Œ `+n(l(i).stats.running)+` ä¸ªè¿è¡Œä¸­ï¼Œ `+n(l(i).stats.updateable)+` ä¸ªå¯æ›´æ–° `,1)]),_:1})]),c(`div`,Fe,[f(u,{type:`primary`,onClick:Re,circle:``,size:`tiny`},{icon:I(()=>[f(a,null,{default:I(()=>[f(l(oe))]),_:1})]),_:1}),f(u,{onClick:r[1]||=e=>P.value=!0,circle:``,size:`tiny`},{icon:I(()=>[f(a,null,{default:I(()=>[f(l(Y))]),_:1})]),_:1}),f(u,{onClick:Be,loading:l(i).loading,circle:``,size:`tiny`},{icon:I(()=>[f(a,null,{default:I(()=>[f(l(fe))]),_:1})]),_:1},8,[`loading`])])])])),f(Oe,{show:P.value,"onUpdate:show":r[2]||=e=>P.value=e,onSuccess:Ve},null,8,[`show`]),f(X,{show:R.value,"onUpdate:show":r[3]||=e=>R.value=e,container:z.value},null,8,[`show`,`container`])])}}}),[[`__scopeId`,`data-v-c6e560ec`]]);export{Ie as default};
//# sourceMappingURL=ContainersView-BR8LwZZf.js.map