import{$ as e,$t as t,A as n,D as r,Dn as i,F as a,Gt as o,Kt as s,Ln as c,O as l,Q as u,Qt as d,S as f,U as ee,Ut as p,Wt as m,Yt as h,Zt as g,c as _,cn as v,fn as y,j as b,kn as x,nt as S,o as C,p as w,q as T,qt as E,rt as D,un as O,yn as k}from"./ui-CdsL-WMe.js";import"./common-B7iQJWwr.js";import{a as A,t as j}from"./index-KvlnPhMc.js";import{t as M}from"./AddOutline-5m_57jxw.js";var N={xmlns:`http://www.w3.org/2000/svg`,"xmlns:xlink":`http://www.w3.org/1999/xlink`,viewBox:`0 0 512 512`},P=t({name:`SaveOutline`,render:function(e,t){return O(),h(`svg`,N,t[0]||=[s(`path`,{d:`M380.93 57.37A32 32 0 0 0 358.3 48H94.22A46.21 46.21 0 0 0 48 94.22v323.56A46.21 46.21 0 0 0 94.22 464h323.56A46.36 46.36 0 0 0 464 417.78V153.7a32 32 0 0 0-9.37-22.63zM256 416a64 64 0 1 1 64-64a63.92 63.92 0 0 1-64 64zm48-224H112a16 16 0 0 1-16-16v-64a16 16 0 0 1 16-16h192a16 16 0 0 1 16 16v64a16 16 0 0 1-16 16z`,fill:`none`,stroke:`currentColor`,"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`32`},null,-1)])}}),F={class:`settings-page`},I={class:`settings-content`},L={class:`registry-auth-section`},R={class:`welcome-card`},z={class:`save-button-container`},B=j(t({__name:`SettingsView`,setup(t){let j=a(),N=x(!1),B=o(()=>{let e=`http://127.0.0.1:8080`;return V.notify.method==`GET`?`${e}/notify?title={title}&content={content}&url={url}&image={image}`:`${e}/notify`}),V=i({server:{addr:`:8080`},notify:{url:``,method:`GET`,isEnable:!0},docker:{host:``,includeStopped:!1},scan:{cron:``,concurrency:3,cacheTTL:10,isUpdate:!0,allowComposeUpdate:!1},policy:{skipLabels:[`watchdocker.skip=true`],onlyLabels:[],skipLocalBuild:!0,skipPinnedDigest:!0,skipSemverPinned:!0,floatingTags:[`latest`,`main`,`stable`]},registry:{auth:[]},logging:{level:`info`}}),H=[{label:`Debug`,value:`debug`},{label:`Info`,value:`info`},{label:`Warn`,value:`warn`},{label:`Error`,value:`error`}],U=[{label:`GET`,value:`GET`},{label:`POST`,value:`POST`}],W=[{label:`docker.io`,value:`docker.io`,description:`Docker Hub 官方域名`},{label:`GitHub Container Registry`,value:`ghcr.io`,description:`GitHub 容器镜像仓库`}],G=()=>{V.registry.auth.push({host:``,username:``,token:``})},K=e=>{V.registry.auth.splice(e,1)},q=async()=>{if(!N.value){N.value=!0;try{let e=await A.saveConfig(V);if(e.code===0)j.success(`配置保存成功`);else throw Error(e.msg||`保存失败`)}catch(e){j.error(`保存失败: ${e.message||`未知错误`}`)}finally{N.value=!1}}},J=async()=>{try{let e=await A.getConfig();if(e.code===0&&e.data?.config)Object.assign(V,e.data.config),j.success(`配置加载成功`);else throw Error(e.msg||`获取配置失败`)}catch(e){j.error(`加载配置失败: ${e.message||`未知错误`}`)}};return v(async()=>{await J()}),(t,i)=>{let a=S,o=r,v=T,x=w,A=D,j=l,J=u,Y=f,X=C,Z=n,Q=e,te=ee,$=b,ne=_;return O(),h(`div`,F,[s(`div`,I,[d($,{vertical:``,size:`large`},{default:k(()=>[d(J,{title:`通知设置`,embedded:``},{default:k(()=>[d(j,{model:V,"label-placement":`left`,"label-width":`120px`},{default:k(()=>[d(o,{label:`通知地址`},{default:k(()=>[d(a,{value:V.notify.url,"onUpdate:value":i[0]||=e=>V.notify.url=e,placeholder:c(B)},null,8,[`value`,`placeholder`])]),_:1}),d(o,{label:`请求方法`},{default:k(()=>[d(v,{value:V.notify.method,"onUpdate:value":i[1]||=e=>V.notify.method=e,options:U,placeholder:`选择请求方法`},null,8,[`value`])]),_:1}),d(o,{label:`启用通知`},{default:k(()=>[d(x,{value:V.notify.isEnable,"onUpdate:value":i[2]||=e=>V.notify.isEnable=e},null,8,[`value`])]),_:1}),d(A,{title:`占位符说明`,type:`info`,class:`mt-2`},{default:k(()=>[...i[17]||=[g(` 支持在查询参数或路径中使用 title={title}、content={content}、url={url}、image={image} 占位符 `,-1)]]),_:1})]),_:1},8,[`model`])]),_:1}),d(J,{title:`Docker 设置`,embedded:``},{default:k(()=>[d(j,{model:V,"label-placement":`left`,"label-width":`120px`},{default:k(()=>[d(o,{label:`Docker 主机`},{default:k(()=>[d(a,{value:V.docker.host,"onUpdate:value":i[3]||=e=>V.docker.host=e,placeholder:`留空使用默认设置`},null,8,[`value`])]),_:1}),d(o,{label:`包含已停止容器`},{default:k(()=>[d(x,{value:V.docker.includeStopped,"onUpdate:value":i[4]||=e=>V.docker.includeStopped=e},null,8,[`value`])]),_:1})]),_:1},8,[`model`])]),_:1}),d(J,{title:`扫描设置`,embedded:``},{default:k(()=>[d(j,{model:V,"label-placement":`left`,"label-width":`120px`},{default:k(()=>[d(o,{label:`Cron 表达式`},{default:k(()=>[d(a,{value:V.scan.cron,"onUpdate:value":i[5]||=e=>V.scan.cron=e,placeholder:`0 */10 * * * *`},null,8,[`value`])]),_:1}),d(o,{label:`并发数`},{default:k(()=>[d(Y,{value:V.scan.concurrency,"onUpdate:value":i[6]||=e=>V.scan.concurrency=e,min:1,max:20},null,8,[`value`])]),_:1}),d(o,{label:`缓存TTL`},{default:k(()=>[d(Y,{value:V.scan.cacheTTL,"onUpdate:value":i[7]||=e=>V.scan.cacheTTL=e,min:1,placeholder:`5`},{suffix:k(()=>[d(X,{depth:`3`},{default:k(()=>[...i[18]||=[g(`分钟`,-1)]]),_:1})]),_:1},8,[`value`])]),_:1}),d(o,{label:`启用自动更新`},{default:k(()=>[d(x,{value:V.scan.isUpdate,"onUpdate:value":i[8]||=e=>V.scan.isUpdate=e},null,8,[`value`])]),_:1}),d(o,{label:`允许更新 Compose 容器`},{default:k(()=>[d(x,{value:V.scan.allowComposeUpdate,"onUpdate:value":i[9]||=e=>V.scan.allowComposeUpdate=e},null,8,[`value`])]),_:1})]),_:1},8,[`model`])]),_:1}),d(J,{title:`策略设置`,embedded:``},{default:k(()=>[d(j,{model:V,"label-placement":`left`,"label-width":`120px`},{default:k(()=>[d(o,{label:`跳过标签`},{default:k(()=>[d(Z,{value:V.policy.skipLabels,"onUpdate:value":i[10]||=e=>V.policy.skipLabels=e},null,8,[`value`])]),_:1}),d(o,{label:`仅包含标签`},{default:k(()=>[d(Z,{value:V.policy.onlyLabels,"onUpdate:value":i[11]||=e=>V.policy.onlyLabels=e},null,8,[`value`])]),_:1}),d(o,{label:`跳过本地构建`},{default:k(()=>[d(x,{value:V.policy.skipLocalBuild,"onUpdate:value":i[12]||=e=>V.policy.skipLocalBuild=e},null,8,[`value`])]),_:1}),d(o,{label:`跳过固定摘要`},{default:k(()=>[d(x,{value:V.policy.skipPinnedDigest,"onUpdate:value":i[13]||=e=>V.policy.skipPinnedDigest=e},null,8,[`value`])]),_:1}),d(o,{label:`跳过语义化版本`},{default:k(()=>[d(x,{value:V.policy.skipSemverPinned,"onUpdate:value":i[14]||=e=>V.policy.skipSemverPinned=e},null,8,[`value`])]),_:1}),d(o,{label:`浮动标签`},{default:k(()=>[d(Z,{value:V.policy.floatingTags,"onUpdate:value":i[15]||=e=>V.policy.floatingTags=e},null,8,[`value`])]),_:1})]),_:1},8,[`model`])]),_:1}),d(J,{title:`仓库认证`,embedded:``},{default:k(()=>[s(`div`,L,[d($,{vertical:``},{default:k(()=>[(O(!0),h(p,null,y(V.registry.auth,(e,t)=>(O(),h(`div`,{key:t,class:`auth-item`},[d(J,{size:`small`},{action:k(()=>[d(Q,{onClick:e=>K(t),type:`error`,size:`small`,ghost:``},{default:k(()=>[...i[19]||=[g(` 删除 `,-1)]]),_:1},8,[`onClick`])]),default:k(()=>[d(j,{model:e,"label-placement":`left`,"label-width":`80px`},{default:k(()=>[d(o,{label:`主机`},{default:k(()=>[d(v,{value:e.host,"onUpdate:value":t=>e.host=t,options:W,filterable:``,tag:``,placeholder:`选择或输入 registry 主机`},null,8,[`value`,`onUpdate:value`])]),_:2},1024),d(o,{label:`用户名`},{default:k(()=>[d(a,{value:e.username,"onUpdate:value":t=>e.username=t,placeholder:`username`},null,8,[`value`,`onUpdate:value`])]),_:2},1024),d(o,{label:`令牌`},{default:k(()=>[d(a,{value:e.token,"onUpdate:value":t=>e.token=t,type:`password`,"show-password-on":`click`,placeholder:`access token`},null,8,[`value`,`onUpdate:value`])]),_:2},1024)]),_:2},1032,[`model`])]),_:2},1024)]))),128)),d(Q,{onClick:G,type:`primary`,dashed:``},{icon:k(()=>[d(te,null,{default:k(()=>[d(c(M))]),_:1})]),default:k(()=>[i[20]||=g(` 添加仓库认证 `,-1)]),_:1})]),_:1}),d(A,{title:`仓库说明`,type:`info`,class:`mt-4`},{default:k(()=>[...i[21]||=[s(`div`,null,[s(`div`,null,[s(`strong`,null,`内置支持：`)]),s(`ul`,{class:`registry-tips`},[s(`li`,null,[s(`strong`,null,`Docker Hub：`),g(`选择 "dockerhub" 或 "docker.io"`)]),s(`li`,null,[s(`strong`,null,`GitHub：`),g(`选择 "ghcr.io"`)]),s(`li`,null,[s(`strong`,null,`自定义：`),g(`直接输入私有 registry 地址（如 registry.example.com） `)])])],-1)]]),_:1})])]),_:1}),d(J,{title:`日志设置`,embedded:``},{default:k(()=>[d(j,{model:V,"label-placement":`left`,"label-width":`120px`},{default:k(()=>[d(o,{label:`日志级别`},{default:k(()=>[d(v,{value:V.logging.level,"onUpdate:value":i[16]||=e=>V.logging.level=e,options:H},null,8,[`value`])]),_:1})]),_:1},8,[`model`])]),_:1})]),_:1})]),(O(),E(m,{to:`#header`,defer:``},[s(`div`,R,[s(`div`,null,[d(ne,{class:`m-0 text-lg`},{default:k(()=>[...i[22]||=[g(`系统设置`,-1)]]),_:1}),d(X,{depth:`3`,class:`text-xs max-md:hidden`},{default:k(()=>[...i[23]||=[g(` 配置 Watch Docker 的运行参数和策略 `,-1)]]),_:1})])])])),(O(),E(m,{to:`#footer`,defer:``},[s(`div`,z,[d(Q,{type:`primary`,size:`large`,onClick:q,loading:N.value},{icon:k(()=>[d(c(P))]),default:k(()=>[i[24]||=g(` 保存配置 `,-1)]),_:1},8,[`loading`])])]))])}}}),[[`__scopeId`,`data-v-2290dc29`]]);export{B as default};
//# sourceMappingURL=SettingsView-BYeHbjZK.js.map