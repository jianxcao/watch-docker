import{$ as e,$t as t,Bn as n,F as r,Gt as i,Jt as a,Kt as o,Ln as s,Qt as c,U as l,Wt as u,Yt as d,Zt as f,kn as p,ln as m,n as h,o as g,qt as _,un as v,yn as y}from"./ui-CdsL-WMe.js";import{c as b}from"./common-B7iQJWwr.js";import{n as x,t as S}from"./index-KvlnPhMc.js";import{t as C}from"./CloseCircleOutline-CD61R6IW.js";import{t as w}from"./RefreshOutline-DFsFZU2a.js";import{t as T}from"./TerminalOutline-BnC38DdK.js";import"./utils-5F9W9oaT.js";import{t as E}from"./TermView-Dz1I8qWk.js";var D={xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 32 32`};function O(e,t){return v(),d(`svg`,D,[...t[0]||=[o(`path`,{fill:`currentColor`,d:`m29.438 16.572-7.985-7.986a2 2 0 0 0-2.829 0l-5.358 5.358L9 2H7L2 16h2l.999-3h6l.803 2.408-7.216 7.216a2 2 0 0 0 0 2.829L9.132 30h9.59l10.716-10.717a1.917 1.917 0 0 0 0-2.712zM5.665 11l2.331-7 2.336 7zm12.23 17H9.96L6 24.038l6.312-6.311 7.928 7.927zm3.76-3.76-7.928-7.927L20.039 10l7.927 7.927z`},null,-1)]])}var k={render:O},A={class:`terminal-page`},j={class:`terminal-container`},M={key:0,class:`terminal-error`},N={class:`welcome-card`},P={class:`terminal-title`},F={class:`terminal-actions`},I=S(t({__name:`TerminalView`,setup(t){let S=h(),D=r(),O=x(),I=p(),L=p(),R=p(``),z=p(!1),B=p(!1),V={disableStdin:!1,cursorBlink:!0,convertEol:!0,scrollback:1e4,fontSize:14,fontFamily:`Menlo, Monaco, "Courier New", monospace, "Microsoft YaHei", "微软雅黑", "PingFang SC", "Hiragino Sans GB", "Heiti SC", "WenQuanYi Micro Hei", sans-serif`,fontWeight:`normal`,fontWeightBold:`bold`,letterSpacing:0,lineHeight:1.2},H=i(()=>`calc(100vh - ${O.contentSafeTop+O.contentSafeBottom}px)`),{status:U,send:W,open:G,close:K}=b(i(()=>{let e=O.getToken();return`${window.location.protocol===`https:`?`wss:`:`ws:`}//${window.location.host}/api/v1/shell?token=${e}`}),{autoReconnect:!1,immediate:!1,onMessage:(e,t)=>{L.value&&t.data&&L.value.write(new Uint8Array(t.data))},onConnected:e=>{z.value=!1,R.value=``,e&&(e.binaryType=`arraybuffer`)},onDisconnected:()=>{z.value=!1,B.value&&!R.value&&D.warning(`终端连接已断开`)},onError:()=>{z.value=!1,R.value=`WebSocket 连接失败`,D.error(`无法连接到终端`)}}),q=e=>{L.value=e,B.value=!0,e.writeln(`\x1B[1;32m=== 欢迎使用 Web Terminal ===\x1B[0m`),e.writeln(`\x1B[90m正在连接到远程 Shell...\x1B[0m`),e.writeln(``),z.value=!0,G()},J=e=>{U.value===`OPEN`&&W(e)},Y=e=>{console.log(`Terminal resized:`,e)},X=()=>{z.value||(z.value=!0,R.value=``,K(),I.value&&I.value.clear(),L.value&&(L.value.writeln(`\x1B[1;32m=== 重新连接... ===\x1B[0m`),L.value.writeln(``)),setTimeout(()=>{G()},100))},Z=()=>{I.value&&I.value.clear()};return m(()=>{K()}),(t,r)=>{let i=l,p=g,m=e;return v(),d(`div`,A,[o(`div`,j,[R.value?(v(),d(`div`,M,[c(i,{size:`48`,color:s(S).errorColor},{default:y(()=>[c(s(C))]),_:1},8,[`color`]),c(p,null,{default:y(()=>[f(n(R.value),1)]),_:1}),c(m,{type:`primary`,size:`small`,onClick:X,loading:z.value},{default:y(()=>[...r[0]||=[f(` 重新连接 `,-1)]]),_:1},8,[`loading`])])):a(``,!0),R.value?a(``,!0):(v(),_(E,{key:1,ref_key:`termRef`,ref:I,config:V,height:H.value,onReady:q,onData:J,onResize:Y},null,8,[`height`]))]),(v(),_(u,{to:`#header`,defer:``},[o(`div`,N,[o(`div`,P,[c(i,{color:s(S).primaryColor},{default:y(()=>[c(s(T))]),_:1},8,[`color`]),r[1]||=o(`span`,null,`终端`,-1)]),o(`div`,F,[c(m,{circle:``,size:`tiny`,onClick:X,loading:z.value},{icon:y(()=>[c(i,null,{default:y(()=>[c(s(w))]),_:1})]),_:1},8,[`loading`]),c(m,{circle:``,size:`tiny`,onClick:Z},{icon:y(()=>[c(i,null,{default:y(()=>[c(s(k))]),_:1})]),_:1})])])]))])}}}),[[`__scopeId`,`data-v-13296bab`]]);export{I as default};
//# sourceMappingURL=TerminalView-Bwfru3MW.js.map