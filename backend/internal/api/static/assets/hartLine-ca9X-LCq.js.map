{"version":3,"file":"hartLine-ca9X-LCq.js","names":["error: any","_openBlock","_createElementBlock","_createElementVNode"],"sources":["../../src/hooks/useContainer.ts","../../src/assets/svg/hartLine.svg?component"],"sourcesContent":["import { useContainerStore } from '@/store/container'\nimport { useMessage, useDialog, NSpace } from 'naive-ui'\nimport type { ContainerStatus } from '@/common/types'\nimport { h, ref } from 'vue'\nimport { NCheckbox } from 'naive-ui'\n\nexport function useContainer() {\n  const store = useContainerStore()\n  const message = useMessage()\n  const dialog = useDialog()\n\n  // 启动容器\n  const handleStart = async (container: ContainerStatus) => {\n    try {\n      await store.startContainer(container.id)\n      message.success(`容器 ${container.name} 启动成功`)\n    } catch (error: any) {\n      message.error(`启动容器失败: ${error.message}`)\n    }\n  }\n\n  // 停止容器\n  const handleStop = async (container: ContainerStatus) => {\n    try {\n      await store.stopContainer(container.id)\n      message.success(`容器 ${container.name} 停止成功`)\n    } catch (error: any) {\n      message.error(`停止容器失败: ${error.message}`)\n    }\n  }\n\n  // 重启容器\n  const handleRestart = async (container: ContainerStatus) => {\n    try {\n      await store.restartContainer(container.id)\n      message.success(`容器 ${container.name} 重启成功`)\n    } catch (error: any) {\n      message.error(`重启容器失败: ${error.message}`)\n    }\n  }\n\n  // 更新容器\n  const handleUpdate = async (container: ContainerStatus, image?: string) => {\n    try {\n      await store.updateContainer(container.id, image)\n      message.success(`容器 ${container.name} 更新成功`)\n    } catch (error: any) {\n      message.error(`更新容器失败: ${error.message}`)\n    }\n  }\n\n  // 删除容器（带确认）\n  const handleDelete = (container: ContainerStatus) => {\n    // 根据容器运行状态设置默认的强制删除值\n    const forceDefault = container.running\n    const forceValue = ref(forceDefault)\n    const removeVolumesValue = ref(false)\n    const removeNetworksValue = ref(false)\n\n    const d = dialog.warning({\n      title: '确认删除容器',\n      content: () =>\n        h(NSpace, { vertical: true }, () => [\n          h('div', {}, `确定要删除容器 \"${container.name}\" 吗？此操作不可撤销。`),\n          container.running\n            ? h('div', { class: 'text-orange-500 text-sm' }, '注意：容器正在运行中')\n            : h('div', { class: 'text-gray-500 text-sm' }, '容器已停止'),\n          h(\n            NCheckbox,\n            {\n              checked: forceValue.value,\n              'onUpdate:checked': (value: boolean) => {\n                forceValue.value = value\n              },\n            },\n            {\n              default: () => (container.running ? '强制删除 (停止并删除运行中的容器)' : '强制删除'),\n            },\n          ),\n          h(\n            NCheckbox,\n            {\n              checked: removeVolumesValue.value,\n              'onUpdate:checked': (value: boolean) => {\n                removeVolumesValue.value = value\n              },\n            },\n            {\n              default: () => '删除关联的卷 (Volume)',\n            },\n          ),\n          h(\n            NCheckbox,\n            {\n              checked: removeNetworksValue.value,\n              'onUpdate:checked': (value: boolean) => {\n                removeNetworksValue.value = value\n              },\n            },\n            {\n              default: () => '删除关联的网络 (Network)',\n            },\n          ),\n        ]),\n      positiveText: '确认删除',\n      negativeText: '取消',\n      onPositiveClick: async () => {\n        try {\n          d.loading = true\n          await store.deleteContainer(\n            container.id,\n            forceValue.value,\n            removeVolumesValue.value,\n            removeNetworksValue.value,\n          )\n          message.success(`容器 ${container.name} 删除成功`)\n        } catch (error: any) {\n          message.error(`删除容器失败: ${error.message}`)\n        } finally {\n          d.loading = false\n        }\n      },\n    })\n  }\n\n  // 批量更新（带确认）\n  const handleBatchUpdate = () => {\n    const updateableCount = store.updateableContainers.length\n\n    if (updateableCount === 0) {\n      message.info('当前没有可更新的容器')\n      return\n    }\n\n    const d = dialog.info({\n      title: '批量更新确认',\n      content: `发现 ${updateableCount} 个可更新的容器，确定要批量更新吗？`,\n      positiveText: '确认更新',\n      negativeText: '取消',\n      onPositiveClick: async () => {\n        try {\n          d.loading = true\n          const result = await store.batchUpdate()\n\n          if (result.updated.length > 0) {\n            message.success(`成功更新 ${result.updated.length} 个容器`)\n          }\n\n          if (Object.keys(result.failed).length > 0) {\n            const failedNames = Object.keys(result.failed)\n            message.warning(`${failedNames.length} 个容器更新失败: ${failedNames.join(', ')}`)\n          }\n        } catch (error: any) {\n          message.error(`批量更新失败: ${error.message}`)\n        } finally {\n          d.loading = false\n        }\n      },\n    })\n  }\n\n  // 获取容器状态颜色\n  const getStatusColor = (container: ContainerStatus): string => {\n    if (!container.running) {\n      return 'warning'\n    }\n\n    switch (container.status) {\n      case 'UpToDate':\n        return 'success'\n      case 'UpdateAvailable':\n        return 'info'\n      case 'Error':\n        return 'error'\n      case 'Skipped':\n        return 'default'\n      default:\n        return 'default'\n    }\n  }\n\n  // 获取容器状态文本\n  const getStatusText = (container: ContainerStatus): string => {\n    if (!container.running) {\n      return '已停止'\n    }\n\n    switch (container.status) {\n      case 'UpToDate':\n        return '最新'\n      case 'UpdateAvailable':\n        return '可更新'\n      case 'Error':\n        return '错误'\n      case 'Skipped':\n        return '跳过'\n      default:\n        return '未知'\n    }\n  }\n\n  // 获取运行状态颜色\n  const getRunningStatusColor = (running: boolean): string => {\n    return running ? 'success' : 'default'\n  }\n\n  // 获取运行状态文本\n  const getRunningStatusText = (running: boolean): string => {\n    return running ? '运行中' : '已停止'\n  }\n\n  // 导出容器\n  const handleExport = async (container: ContainerStatus) => {\n    try {\n      await store.exportContainer(container.id)\n      message.success(`容器 ${container.name} 导出成功`)\n    } catch (error: any) {\n      message.error(`导出容器失败: ${error.message}`)\n    }\n  }\n\n  return {\n    // 操作方法\n    handleStart,\n    handleStop,\n    handleRestart,\n    handleUpdate,\n    handleDelete,\n    handleBatchUpdate,\n    handleExport,\n\n    // 工具方法\n    getStatusColor,\n    getStatusText,\n    getRunningStatusColor,\n    getRunningStatusText,\n  }\n}\n","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"20\",\n  height: \"20\",\n  fill: \"none\"\n}\n\nexport function render(_ctx, _cache) {\n  return (_openBlock(), _createElementBlock(\"svg\", _hoisted_1, [...(_cache[0] || (_cache[0] = [\n    _createElementVNode(\"g\", { \"clip-path\": \"url(#a)\" }, [\n      _createElementVNode(\"path\", {\n        stroke: \"currentColor\",\n        \"stroke-linecap\": \"round\",\n        \"stroke-linejoin\": \"round\",\n        \"stroke-width\": \"1.667\",\n        d: \"M18.333 10h-2.066a1.666 1.666 0 0 0-1.609 1.217L12.7 18.183a.208.208 0 0 1-.4 0L7.7 1.817a.208.208 0 0 0-.4 0L5.342 8.783A1.67 1.67 0 0 1 3.742 10H1.667\"\n      })\n    ], -1),\n    _createElementVNode(\"defs\", null, [\n      _createElementVNode(\"clipPath\", { id: \"a\" }, [\n        _createElementVNode(\"path\", {\n          fill: \"#fff\",\n          d: \"M0 0h20v20H0z\"\n        })\n      ])\n    ], -1)\n  ]))]))\n}\nexport default { render: render }"],"mappings":"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"}